<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="diaryMapper" >
 
 	<resultMap type="Diary" id="diaryResultMap">
 		<id property="diaryNo" column="DIARY_NO"/>
 		<result property="diaryTitle" column="DIARY_TITLE"/>
 		<result property="diaryContent" column="DIARY_CONTENT"/>
 		<result property="diaryDate" column="DIARY_DATE"/>
 		<result property="diaryUpdate" column="DIARY_UPDATE"/>
 		<result property="diaryUpdate" column="DIARY_PICNAME"/>
 		<result property="diaryRepicname" column="DIARY_REPICNAME"/>
 		<result property="companionNo" column="COMPANION_NO"/>
		<result property="memberNo" column="MEMBER_NO"/>
 	</resultMap>
 	<resultMap type="Guestbook" id="guestbookResultMap">
 		<id property="guestbookNo" column="GUESTBOOK_NO"/>
 		<result property="guestbookContent" column="GUESTBOOK_CONTENT"/>
 		<result property="guestbookDate" column="GUESTBOOK_DATE"/>
 		<result property="guestbookUpdate" column="GUESTBOOK_UPDATE"/>
 		<result property="memberNo" column="MEMBER_NO"/>
 		<result property="memberDiary" column="MEMBER_DIARY"/>
 		<result property="memberNick" column="MEMBER_NICK" />
 	</resultMap>
 	
	<select id="selectGuestbookList" parameterType="Guestbook" resultMap="guestbookResultMap">
		SELECT GUESTBOOK_NO, GUESTBOOK_CONTENT, GUESTBOOK_DATE, GUESTBOOK_UPDATE, MEMBER_NO, MEMBER_NICK ,MEMBER_DIARY 
		FROM GUESTBOOK JOIN MEMBER USING(MEMBER_NO) WHERE MEMBER_DIARY = #{memberDiary} ORDER BY GUESTBOOK_DATE DESC
	</select>
	
	<insert id="insertGuestbook">
		INSERT INTO GUESTBOOK 
		VALUES (SEQ_GUESTBOOK.NEXTVAL, #{guestbookContent},DEFAULT,DEFAULT,#{memberNo},#{memberDiary})
	</insert>
	
	<update id="updateGuestbook">
		UPDATE GUESTBOOK SET GUESTBOOK_CONTENT = #{guestbookContent},GUESTBOOK_UPDATE = SYSDATE WHERE GUESTBOOK_NO = #{guestbookNo}
	</update>
	
	<delete id="deleteGuestbook">
		DELETE FROM GUESTBOOK WHERE GUESTBOOK_NO = #{guestbookNo}
	</delete>

 </mapper>